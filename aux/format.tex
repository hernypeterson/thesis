% highlight boxes
\usepackage[most]{tcolorbox} 
    % multiline highlight
    \definecolor{light-gray}{gray}{0.9}
    \tcbset{
        on line, boxsep=3pt, left=0pt,right=0pt,top=0pt,bottom=-1pt, colframe=white,colback=light-gray, highlight math style={enhanced}
    }

    % Sans serif grey highlight for software tools
    \newcommand{\hltt}[1]{\tcbox{\vphantom{lg}\texttt{#1}}}

    % typewriter grey highlight for code
    \newcommand{\hlss}[1]{\tcbox{\vphantom{lg}{\sffamily{#1}}}}

% Justification
\usepackage[nopatch=footnote]{microtype} % small adjustments
\usepackage{indentfirst} % paragraphs

% vertical spacing
\usepackage{setspace}
\setstretch{1.5}

% Page Header & Footer
\usepackage[twoside]{fancyhdr}

% custom running header
\makeatletter % use @ as letter character
\renewcommand{\chaptermark}[1]{\markboth{\ifnum\value{chapter}=0\else\@chapapp~\thechapter: \fi #1}{}} % don't show chapter number in header if 0 (frontmatter lists)
\makeatother % protect @ character

\renewcommand{\headrulewidth}{0.5pt}
\setlength{\headheight}{15pt}
\addtolength{\topmargin}{-2.5pt}
\usepackage{appendix}

\newcommand\MakeMarkcase{} % remove \MakeUppercase (replace with small caps below)


% custom page header
\AtBeginDocument{
    \pagestyle{fancy}
    \fancyhead{} % clear all header fields
    \fancyhead[RE,LO]{\textsc\leftmark} % chapter outer upper corner
    \fancyfoot{} % clear all footer fields
    \fancyfoot[C]{\thepage} % page number center bottom
}

% Chapter Header with box 
\usepackage{titlesec}
\titleformat{\chapter}[frame]
{\normalfont}{\filright\fbox{\enspace%
{\textsc{\chaptertitlename~\thechapter}}\enspace}}{8pt}{\Large\bfseries\filcenter}

% table of contents and list of figures (no MakeUpperCase nonsense)
\makeatletter
\renewcommand\tableofcontents{%
    \chapter*{\contentsname
        \@mkboth{%
           \contentsname}{\contentsname}}%
    \@starttoc{toc}%
}

\makeatother

% hack to make small caps header
\renewcommand\listfigurename{L\lowercase{ist of} F\lowercase{igures}}

% Footnotes
\usepackage[hang,splitrule,multiple]{footmisc}
\setlength{\footnotemargin}{1em}
