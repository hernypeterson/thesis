\chapter{Code}\label{app:code}

    
Modules.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k+kn}{import} \PY{n}{radians} \PY{k}{as} \PY{n}{rad}
\PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k+kn}{import} \PY{n}{degrees} \PY{k}{as} \PY{n}{deg}
\PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k+kn}{import} \PY{n}{sin}\PY{p}{,} \PY{n}{cos}\PY{p}{,} \PY{n}{tan}\PY{p}{,} \PY{n}{arcsin}\PY{p}{,} \PY{n}{arccos}\PY{p}{,} \PY{n}{arctan}\PY{p}{,} \PY{n}{arctan2}\PY{p}{,} \PY{n}{mean}

\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{from} \PY{n+nn}{dataclasses} \PY{k+kn}{import} \PY{n}{dataclass}
\PY{k+kn}{import} \PY{n+nn}{itertools}

\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{optimize} \PY{k+kn}{import} \PY{n}{curve\PYZus{}fit}

\PY{k+kn}{from} \PY{n+nn}{typing} \PY{k+kn}{import} \PY{n}{Callable}\PY{p}{,} \PY{n}{Tuple}
\PY{k+kn}{from} \PY{n+nn}{collections}\PY{n+nn}{.}\PY{n+nn}{abc} \PY{k+kn}{import} \PY{n}{Iterable}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{backends}\PY{n+nn}{.}\PY{n+nn}{backend\PYZus{}pdf} \PY{k+kn}{import} \PY{n}{PdfPages}
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
\end{Verbatim}
\end{tcolorbox}

Numerical constants.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{SHEAR\PYZus{}MODULUS} \PY{o}{=} \PY{l+m+mf}{2.4e10}  \PY{c+c1}{\PYZsh{} Pa}
\PY{n}{ROCK\PYZus{}DENSITY} \PY{o}{=} \PY{l+m+mi}{2700}  \PY{c+c1}{\PYZsh{} kg / m\PYZca{}3}
\PY{n}{MAGMA\PYZus{}DENSITY} \PY{o}{=} \PY{l+m+mi}{2700}  \PY{c+c1}{\PYZsh{} kg / m\PYZca{}3}
\PY{n}{MARS\PYZus{}GRAVITY} \PY{o}{=} \PY{l+m+mf}{3.72}  \PY{c+c1}{\PYZsh{} m / s\PYZca{}2}
\PY{n}{MARS\PYZus{}EQ\PYZus{}RADIUS} \PY{o}{=} \PY{l+m+mi}{3\PYZus{}396\PYZus{}200}  \PY{c+c1}{\PYZsh{} m}

\PY{n}{AZ1\PYZus{}UNCERTAINTY} \PY{o}{=} \PY{l+m+mi}{7}  \PY{c+c1}{\PYZsh{} degrees}

\PY{c+c1}{\PYZsh{} for plotting numerical}
\PY{n}{PLOT\PYZus{}WIDTH} \PY{o}{=} \PY{l+m+mi}{200\PYZus{}000}

\PY{c+c1}{\PYZsh{} scale length dimensions to prevent overflow}
\PY{n}{LENGTH\PYZus{}SCALE\PYZus{}MULT} \PY{o}{=} \PY{l+m+mi}{1\PYZus{}000\PYZus{}000}

\PY{c+c1}{\PYZsh{} for cutoff envelope and first guess in non\PYZhy{}linear regression}
\PY{n}{MAX\PYZus{}EPV} \PY{o}{=} \PY{l+m+mf}{7e22}  \PY{c+c1}{\PYZsh{} J}
\PY{n}{TEST\PYZus{}D} \PY{o}{=} \PY{l+m+mi}{20\PYZus{}000}  \PY{c+c1}{\PYZsh{} m}
\PY{n}{MAX\PYZus{}ITERATIONS} \PY{o}{=} \PY{l+m+mi}{80}

\PY{c+c1}{\PYZsh{} parameter conversion factor}
\PY{n}{EPV\PYZus{}OVER\PYZus{}K} \PY{o}{=} \PY{l+m+mi}{16} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{*} \PY{n}{SHEAR\PYZus{}MODULUS} \PY{o}{/} \PY{l+m+mi}{9}
\end{Verbatim}
\end{tcolorbox}

\hypertarget{functions}{%
\section{Functions}\label{functions}}

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{save\PYZus{}pdf}\PY{p}{(}\PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{plot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}  \PY{c+c1}{\PYZsh{} prevent clipping edge labels}
\PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figures/}\PY{l+s+si}{\PYZob{}}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{.pdf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{mogi\PYZus{}tilt}\PY{p}{(}\PY{n}{dist}\PY{p}{,} \PY{n}{epv}\PY{p}{,} \PY{n}{d}\PY{p}{)}\PY{p}{:}
\PY{n}{k} \PY{o}{=} \PY{n}{epv} \PY{o}{/} \PY{n}{EPV\PYZus{}OVER\PYZus{}K}

\PY{c+c1}{\PYZsh{} scale to prevent overflow}
\PY{n}{r1\PYZus{}scale} \PY{o}{=} \PY{n}{dist} \PY{o}{/} \PY{n}{LENGTH\PYZus{}SCALE\PYZus{}MULT}
\PY{n}{k\PYZus{}scale} \PY{o}{=} \PY{n}{k} \PY{o}{/} \PY{p}{(}\PY{n}{LENGTH\PYZus{}SCALE\PYZus{}MULT} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{d\PYZus{}scale} \PY{o}{=} \PY{n}{d} \PY{o}{/} \PY{n}{LENGTH\PYZus{}SCALE\PYZus{}MULT}

\PY{n}{num} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n}{k\PYZus{}scale} \PY{o}{*} \PY{n}{d\PYZus{}scale} \PY{o}{*} \PY{n}{r1\PYZus{}scale}
\PY{n}{denom} \PY{o}{=} \PY{p}{(}\PY{n}{d\PYZus{}scale}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{r1\PYZus{}scale}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{2.5} \PY{o}{+} \PYZbs{}
    \PY{n}{k\PYZus{}scale} \PY{o}{*} \PY{p}{(}\PY{n}{d\PYZus{}scale}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{r1\PYZus{}scale}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
\PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{degrees}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arctan2}\PY{p}{(}\PY{n}{num}\PY{p}{,} \PY{n}{denom}\PY{p}{)}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{calculate\PYZus{}epv}\PY{p}{(}\PY{n}{depth}\PY{p}{,} \PY{n}{radius}\PY{p}{,} \PY{n}{aspect}\PY{p}{,} \PY{n}{pmult}\PY{p}{)}\PY{p}{:}
\PY{n}{half\PYZus{}height} \PY{o}{=} \PY{n}{radius} \PY{o}{*} \PY{n}{aspect}
\PY{n}{volume} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{4}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{*} \PY{n}{radius}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{half\PYZus{}height}
\PY{n}{pressure} \PY{o}{=} \PY{n}{ROCK\PYZus{}DENSITY} \PY{o}{*} \PY{n}{MARS\PYZus{}GRAVITY} \PY{o}{*} \PY{n}{depth} \PY{o}{*} \PY{n}{pmult}
\PY{k}{return} \PY{n}{volume} \PY{o}{*} \PY{n}{pressure}


\PY{k}{def} \PY{n+nf}{dist}\PY{p}{(}\PY{n}{lat\PYZus{}sample}\PY{p}{,} \PY{n}{lon\PYZus{}sample}\PY{p}{,} \PY{n}{lat\PYZus{}center}\PY{p}{,} \PY{n}{lon\PYZus{}center}\PY{p}{)}\PY{p}{:}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}distance between pts 1 and 2\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{n}{lat1} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lat\PYZus{}sample}\PY{p}{)}
\PY{n}{lon1} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lon\PYZus{}sample}\PY{p}{)}
\PY{n}{lat2} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lat\PYZus{}center}\PY{p}{)}
\PY{n}{lon2} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lon\PYZus{}center}\PY{p}{)}
\PY{n}{rads} \PY{o}{=} \PY{n}{arccos}\PY{p}{(}
    \PY{n}{cos}\PY{p}{(}\PY{n}{lat1}\PY{p}{)} \PY{o}{*} \PY{n}{cos}\PY{p}{(}\PY{n}{lat2}\PY{p}{)}
    \PY{o}{*} \PY{n}{cos}\PY{p}{(}\PY{n}{lon2} \PY{o}{\PYZhy{}} \PY{n}{lon1}\PY{p}{)}
    \PY{o}{+} \PY{n}{sin}\PY{p}{(}\PY{n}{lat1}\PY{p}{)} \PY{o}{*} \PY{n}{sin}\PY{p}{(}\PY{n}{lat2}\PY{p}{)}
\PY{p}{)}
\PY{k}{return} \PY{n}{rads} \PY{o}{*} \PY{n}{MARS\PYZus{}EQ\PYZus{}RADIUS}


\PY{k}{def} \PY{n+nf}{bearing}\PY{p}{(}\PY{n}{lat\PYZus{}sample}\PY{p}{,} \PY{n}{lon\PYZus{}sample}\PY{p}{,} \PY{n}{lat\PYZus{}center}\PY{p}{,} \PY{n}{lon\PYZus{}center}\PY{p}{)}\PY{p}{:}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}angle from pt 1 AWAY from pt 2\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{n}{lat1} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lat\PYZus{}sample}\PY{p}{)}
\PY{n}{lon1} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lon\PYZus{}sample}\PY{p}{)}
\PY{n}{lat2} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lat\PYZus{}center}\PY{p}{)}
\PY{n}{lon2} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{lon\PYZus{}center}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{sin}\PY{p}{(}\PY{n}{lon2} \PY{o}{\PYZhy{}} \PY{n}{lon1}\PY{p}{)} \PY{o}{*} \PY{n}{cos}\PY{p}{(}\PY{n}{lat2}\PY{p}{)}
\PY{n}{x} \PY{o}{=} \PY{n}{cos}\PY{p}{(}\PY{n}{lat1}\PY{p}{)} \PY{o}{*} \PY{n}{sin}\PY{p}{(}\PY{n}{lat2}\PY{p}{)} \PYZbs{}
    \PY{o}{\PYZhy{}} \PY{n}{sin}\PY{p}{(}\PY{n}{lat1}\PY{p}{)} \PY{o}{*} \PY{n}{cos}\PY{p}{(}\PY{n}{lat2}\PY{p}{)} \PY{o}{*} \PY{n}{cos}\PY{p}{(}\PY{n}{lon2} \PY{o}{\PYZhy{}} \PY{n}{lon1}\PY{p}{)}
\PY{k}{return} \PY{p}{(}\PY{l+m+mi}{180} \PY{o}{+} \PY{n}{deg}\PY{p}{(}\PY{n}{arctan2}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{l+m+mi}{360}


\PY{c+c1}{\PYZsh{} for beta, discordance calculations}
\PY{k}{def} \PY{n+nf}{signed\PYZus{}ang\PYZus{}diff}\PY{p}{(}\PY{n}{az}\PY{p}{,} \PY{n}{bearing}\PY{p}{)}\PY{p}{:}
\PY{k}{return} \PY{p}{(}\PY{p}{(}\PY{n}{az} \PY{o}{\PYZhy{}} \PY{n}{bearing} \PY{o}{+} \PY{l+m+mi}{180}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{l+m+mi}{360}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{180}


\PY{k}{def} \PY{n+nf}{sl1}\PY{p}{(}\PY{n}{beta1}\PY{p}{,} \PY{n}{beta2}\PY{p}{,} \PY{n}{sl2}\PY{p}{)}\PY{p}{:}
\PY{n}{beta1} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{beta1}\PY{p}{)}
\PY{n}{beta2} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{beta2}\PY{p}{)}
\PY{n}{sl2} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{sl2}\PY{p}{)}
\PY{n}{arg} \PY{o}{=} \PY{n}{sin}\PY{p}{(}\PY{n}{beta2}\PY{p}{)} \PY{o}{*} \PY{n}{sin}\PY{p}{(}\PY{n}{sl2}\PY{p}{)} \PY{o}{/} \PY{n}{sin}\PY{p}{(}\PY{n}{beta1}\PY{p}{)}
\PY{k}{if} \PY{n}{arg} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0} \PY{o+ow}{or} \PY{n}{arg} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}  \PY{c+c1}{\PYZsh{} not possible}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
\PY{k}{else}\PY{p}{:}
    \PY{n}{sl1} \PY{o}{=} \PY{n}{arcsin}\PY{p}{(}\PY{n}{arg}\PY{p}{)}
    \PY{k}{return} \PY{n}{deg}\PY{p}{(}\PY{n}{sl1}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{proj}\PY{p}{(}\PY{n}{beta}\PY{p}{,} \PY{n}{sl}\PY{p}{)}\PY{p}{:}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}project small circle point onto great circle\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{n}{beta} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{beta}\PY{p}{)}
\PY{n}{sl} \PY{o}{=} \PY{n}{rad}\PY{p}{(}\PY{n}{sl}\PY{p}{)}
\PY{n}{proj} \PY{o}{=} \PY{n}{arctan}\PY{p}{(}\PY{n}{tan}\PY{p}{(}\PY{n}{beta}\PY{p}{)} \PY{o}{*} \PY{n}{cos}\PY{p}{(}\PY{n}{beta}\PY{p}{)}\PY{p}{)}
\PY{k}{return} \PY{n}{deg}\PY{p}{(}\PY{n}{proj}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{tilt}\PY{p}{(}\PY{n}{beta1\PYZus{}measured}\PY{p}{,} \PY{n}{beta2}\PY{p}{,} \PY{n}{sl2}\PY{p}{,} \PY{n}{dist}\PY{p}{,} \PY{n}{az1\PYZus{}uncertainty}\PY{o}{=}\PY{n}{AZ1\PYZus{}UNCERTAINTY}\PY{p}{)}\PY{p}{:}

\PY{c+c1}{\PYZsh{} within uncertainty (non\PYZhy{}discordance condition)}
\PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{signed\PYZus{}ang\PYZus{}diff}\PY{p}{(}\PY{n}{beta1\PYZus{}measured}\PY{p}{,} \PY{n}{beta2}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{az1\PYZus{}uncertainty}\PY{p}{:}
    \PY{k}{return} \PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} early exit from function}

\PY{c+c1}{\PYZsh{} beta1 uncertainty boundaries }
\PY{n}{beta1\PYZus{}possible} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
    \PY{n}{beta1\PYZus{}measured} \PY{o}{+} \PY{n}{az1\PYZus{}uncertainty}\PY{p}{,}
    \PY{n}{beta1\PYZus{}measured} \PY{o}{\PYZhy{}} \PY{n}{az1\PYZus{}uncertainty}
\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} compute resulting sl1 for each beta1 boundary}
\PY{n}{sl1\PYZus{}possible} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
    \PY{n}{sl1}\PY{p}{(}\PY{n}{beta1}\PY{p}{,} \PY{n}{beta2}\PY{p}{,} \PY{n}{sl2}\PY{p}{)} \PY{k}{for} \PY{n}{beta1} \PY{o+ow}{in} \PY{n}{beta1\PYZus{}possible}
\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} remove any impossible boundary calculations}
\PY{n}{beta1\PYZus{}possible} \PY{o}{=} \PY{n}{beta1\PYZus{}possible}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sl1\PYZus{}possible}\PY{p}{)}\PY{p}{]}
\PY{n}{sl1\PYZus{}possible} \PY{o}{=} \PY{n}{sl1\PYZus{}possible}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sl1\PYZus{}possible}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} make (beta1, sl1) pairs of resulting (mathematically possible)}
\PY{n}{beta1\PYZus{}sl1\PYZus{}zip} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{beta1\PYZus{}possible}\PY{p}{,} \PY{n}{sl1\PYZus{}possible}\PY{p}{)}

\PY{c+c1}{\PYZsh{} no possible tilts (mathematical condition)}
\PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sl1\PYZus{}possible}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{c+c1}{\PYZsh{} early exit from function}

\PY{c+c1}{\PYZsh{} evaluate tilt for }
\PY{n}{tilt\PYZus{}possible} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{proj}\PY{p}{(}\PY{n}{beta2}\PY{p}{,} \PY{n}{sl2}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{proj}\PY{p}{(}\PY{o}{*}\PY{n}{pair}\PY{p}{)}\PY{k}{for} \PY{n}{pair} \PY{o+ow}{in} \PY{n}{beta1\PYZus{}sl1\PYZus{}zip}\PY{p}{]}
\PY{p}{)}

\PY{c+c1}{\PYZsh{} find index (boundary) with the lowest tilt magnitude }
\PY{n}{lowest\PYZus{}abs\PYZus{}tilt\PYZus{}arg} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{tilt\PYZus{}possible}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} envelope cutoff (physical plausibility condition)}
\PY{n}{max\PYZus{}tilt} \PY{o}{=} \PY{n}{mogi\PYZus{}tilt}\PY{p}{(}\PY{n}{dist}\PY{o}{=}\PY{n}{dist}\PY{p}{,} \PY{n}{epv}\PY{o}{=}\PY{n}{MAX\PYZus{}EPV}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{TEST\PYZus{}D}\PY{p}{)}
\PY{n}{min\PYZus{}tilt} \PY{o}{=} \PY{n}{mogi\PYZus{}tilt}\PY{p}{(}\PY{n}{dist}\PY{o}{=}\PY{n}{dist}\PY{p}{,} \PY{n}{epv}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{MAX\PYZus{}EPV}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{TEST\PYZus{}D}\PY{p}{)}

\PY{k}{if} \PY{n}{tilt\PYZus{}possible}\PY{p}{[}\PY{n}{lowest\PYZus{}abs\PYZus{}tilt\PYZus{}arg}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{max\PYZus{}tilt}\PY{p}{:}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{c+c1}{\PYZsh{} early exit}
\PY{k}{if} \PY{n}{tilt\PYZus{}possible}\PY{p}{[}\PY{n}{lowest\PYZus{}abs\PYZus{}tilt\PYZus{}arg}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{min\PYZus{}tilt}\PY{p}{:}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{c+c1}{\PYZsh{} early exit}

\PY{c+c1}{\PYZsh{} if no early exits, return lowest computed tilt }
\PY{k}{return} \PY{n}{tilt\PYZus{}possible}\PY{p}{[}\PY{n}{lowest\PYZus{}abs\PYZus{}tilt\PYZus{}arg}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

Envelope plot.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}

\PY{n}{test\PYZus{}dist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{100\PYZus{}000}\PY{p}{)}
\PY{n}{test\PYZus{}max\PYZus{}tilt} \PY{o}{=} \PY{n}{mogi\PYZus{}tilt}\PY{p}{(}\PY{n}{test\PYZus{}dist}\PY{p}{,} \PY{n}{MAX\PYZus{}EPV}\PY{p}{,} \PY{n}{TEST\PYZus{}D}\PY{p}{)}
\PY{n}{test\PYZus{}min\PYZus{}tilt} \PY{o}{=} \PY{n}{mogi\PYZus{}tilt}\PY{p}{(}\PY{n}{test\PYZus{}dist}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{MAX\PYZus{}EPV}\PY{p}{,} \PY{n}{TEST\PYZus{}D}\PY{p}{)}
\PY{n}{test\PYZus{}dist\PYZus{}km} \PY{o}{=} \PY{n}{test\PYZus{}dist} \PY{o}{/} \PY{l+m+mi}{1000}

\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{test\PYZus{}dist\PYZus{}km}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{test\PYZus{}max\PYZus{}tilt}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Maximum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{test\PYZus{}dist\PYZus{}km}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{test\PYZus{}min\PYZus{}tilt}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Minimum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tilt Cutoff Envelope using \PYZdl{}d = \PYZdl{}}\PY{l+s+si}{\PYZob{}}\PY{n}{TEST\PYZus{}D}\PY{o}{/}\PY{l+m+mi}{1000}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ km, }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}E\PYZus{}}\PY{l+s+si}{\PYZob{}PV\PYZcb{}}\PY{l+s+s2}{ = \PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{MAX\PYZus{}EPV}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ J}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tilt (deg)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{add\PYZus{}envelope\PYZus{}to\PYZus{}plot}\PY{p}{(}\PY{n+nb}{min}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n+nb}{max}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
\PY{k}{if} \PY{n+nb}{max}\PY{p}{:}
    \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{test\PYZus{}dist\PYZus{}km}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{test\PYZus{}max\PYZus{}tilt}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{if} \PY{n+nb}{min}\PY{p}{:}
    \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{test\PYZus{}dist\PYZus{}km}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{test\PYZus{}min\PYZus{}tilt}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} save\PYZus{}pdf(name=\PYZsq{}envelope\PYZsq{})}
\end{Verbatim}
\end{tcolorbox}

\hypertarget{map-data}{%
\section{Map Data}\label{map-data}}

Read samples.csv and centers.csv and extract IDs for each.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} location to read .csv files}
\PY{n}{map\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../GEOL192\PYZhy{}GIS/data/}\PY{l+s+s2}{\PYZdq{}}


\PY{n}{centers} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{map\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{centers.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{samples} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{map\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{samples.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FEATURE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{cIDs} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n}{centers}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{n}{sIDs} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n}{samples}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Define an object to organize, calculate, and plot map data for a single
center point.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@dataclass}
\PY{k}{class} \PY{n+nc}{Center}\PY{p}{:}
\PY{n}{cID}\PY{p}{:} \PY{n+nb}{int}

\PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}post\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data} \PY{o}{=} \PY{n}{samples}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} this of course only works for unique self.cIDs}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lat} \PY{o}{=} \PY{n}{centers}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cID}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LAT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lon} \PY{o}{=} \PY{n}{centers}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cID}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LON}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{calculate}\PY{p}{(}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{plot}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} type: ignore}
    \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}

    \PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Tilt from Center }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cID}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ under cutoff: }\PY{l+s+si}{\PYZob{}}\PY{n}{MAX\PYZus{}EPV} \PY{l+s+si}{= \PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}}\PY{n}{TEST\PYZus{}D} \PY{l+s+si}{= \PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Distance (km)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Tilt (deg)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} save plot with name if passed as argument}
    \PY{k}{if} \PY{n}{name} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{save\PYZus{}pdf}\PY{p}{(}\PY{n}{name}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{calculate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}
        \PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{n}{dist}\PY{p}{(}
            \PY{n}{lat\PYZus{}sample}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LAT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{lon\PYZus{}sample}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LON}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{lat\PYZus{}center}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lat}\PY{p}{,} \PY{n}{lon\PYZus{}center}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lon}
        \PY{p}{)}\PY{p}{,}
        \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist\PYZus{}km}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}
        \PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{l+m+mi}{1000}\PY{p}{,}
        \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bearing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}
        \PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{n}{bearing}\PY{p}{(}
            \PY{n}{lat\PYZus{}sample}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LAT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{lon\PYZus{}sample}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LON}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{lat\PYZus{}center}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lat}\PY{p}{,} \PY{n}{lon\PYZus{}center}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lon}
        \PY{p}{)}\PY{p}{,}
        \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}
        \PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{n}{signed\PYZus{}ang\PYZus{}diff}\PY{p}{(}
            \PY{n}{az}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AZ1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{bearing}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bearing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{p}{)}\PY{p}{,}
        \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}
        \PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{n}{signed\PYZus{}ang\PYZus{}diff}\PY{p}{(}
            \PY{n}{az}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AZ2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{bearing}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bearing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{p}{)}\PY{p}{,}
        \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{p}{)}
    
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}
        \PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{n}{tilt}\PY{p}{(}
            \PY{n}{beta1\PYZus{}measured}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{beta2}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sl2}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SL2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{dist}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{p}{)}\PY{p}{,}
        \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Make an object for each center. This takes less than a minute on my
machine.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{centers\PYZus{}calc} \PY{o}{=} \PY{p}{[}\PY{n}{Center}\PY{p}{(}\PY{n}{cID}\PY{p}{)} \PY{k}{for} \PY{n}{cID} \PY{o+ow}{in} \PY{n}{cIDs}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

Define sample populations based on their sIDs and feature type.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@dataclass}
\PY{k}{class} \PY{n+nc}{Population}\PY{p}{:}
\PY{n}{feature}\PY{p}{:} \PY{n+nb}{tuple} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{channel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{sIDs}\PY{p}{:} \PY{n+nb}{tuple} \PY{o}{=} \PY{n}{sIDs}  \PY{c+c1}{\PYZsh{} type: ignore}

\PY{c+c1}{\PYZsh{} not used}
\PY{n}{SE\PYZus{}ALL\PYZus{}sIDs} \PY{o}{=} \PY{p}{(}
\PY{l+m+mi}{41}\PY{p}{,} \PY{l+m+mi}{193}\PY{p}{,} \PY{l+m+mi}{194}\PY{p}{,} \PY{l+m+mi}{195}\PY{p}{,} \PY{l+m+mi}{196}\PY{p}{,} \PY{l+m+mi}{197}\PY{p}{,} \PY{l+m+mi}{198}\PY{p}{,} \PY{l+m+mi}{202}\PY{p}{,} \PY{l+m+mi}{203}\PY{p}{,} \PY{l+m+mi}{430}\PY{p}{,} \PY{l+m+mi}{431}\PY{p}{,} \PY{l+m+mi}{432}\PY{p}{,} \PY{l+m+mi}{438}\PY{p}{,} \PY{l+m+mi}{439}\PY{p}{,} \PY{l+m+mi}{440}\PY{p}{,} \PY{l+m+mi}{441}\PY{p}{,} \PY{l+m+mi}{442}\PY{p}{,} \PY{l+m+mi}{443}\PY{p}{,} \PY{l+m+mi}{444}\PY{p}{,} \PY{l+m+mi}{445}\PY{p}{,} \PY{l+m+mi}{477}\PY{p}{,} \PY{l+m+mi}{478}\PY{p}{,} \PY{l+m+mi}{479}\PY{p}{,} \PY{l+m+mi}{480}\PY{p}{,} \PY{l+m+mi}{481}\PY{p}{,} \PY{l+m+mi}{490}\PY{p}{,}
\PY{l+m+mi}{491}\PY{p}{,} \PY{l+m+mi}{492}\PY{p}{,} \PY{l+m+mi}{493}\PY{p}{,} \PY{l+m+mi}{524}\PY{p}{,} \PY{l+m+mi}{525}\PY{p}{,} \PY{l+m+mi}{526}\PY{p}{,} \PY{l+m+mi}{529}\PY{p}{,} \PY{l+m+mi}{530}\PY{p}{,} \PY{l+m+mi}{531}\PY{p}{,} \PY{l+m+mi}{532}\PY{p}{,} \PY{l+m+mi}{533}\PY{p}{,} \PY{l+m+mi}{534}\PY{p}{,} \PY{l+m+mi}{535}\PY{p}{,} \PY{l+m+mi}{536}\PY{p}{,} \PY{l+m+mi}{537}\PY{p}{,} \PY{l+m+mi}{538}\PY{p}{,} \PY{l+m+mi}{539}\PY{p}{,} \PY{l+m+mi}{540}\PY{p}{,} \PY{l+m+mi}{541}\PY{p}{,} \PY{l+m+mi}{542}\PY{p}{,} \PY{l+m+mi}{543}\PY{p}{,} \PY{l+m+mi}{544}\PY{p}{,} \PY{l+m+mi}{545}\PY{p}{,} \PY{l+m+mi}{546}\PY{p}{,} \PY{l+m+mi}{547}\PY{p}{,} \PY{l+m+mi}{548}\PY{p}{,} \PY{l+m+mi}{549}
\PY{p}{)}

\PY{n}{POP\PYZus{}A\PYZus{}sIDs} \PY{o}{=} \PY{p}{(}
\PY{l+m+mi}{198}\PY{p}{,} \PY{l+m+mi}{438}\PY{p}{,} \PY{l+m+mi}{439}\PY{p}{,} \PY{l+m+mi}{440}\PY{p}{,} \PY{l+m+mi}{441}\PY{p}{,} \PY{l+m+mi}{442}\PY{p}{,} \PY{l+m+mi}{443}\PY{p}{,} \PY{l+m+mi}{444}\PY{p}{,} \PY{l+m+mi}{445}\PY{p}{,} \PY{l+m+mi}{490}\PY{p}{,} \PY{l+m+mi}{491}\PY{p}{,} \PY{l+m+mi}{492}\PY{p}{,} \PY{l+m+mi}{493}
\PY{p}{)}

\PY{n}{POP\PYZus{}B\PYZus{}sIDs} \PY{o}{=} \PY{p}{(}
\PY{l+m+mi}{193}\PY{p}{,} \PY{l+m+mi}{194}\PY{p}{,} \PY{l+m+mi}{195}\PY{p}{,} \PY{l+m+mi}{196}\PY{p}{,} \PY{l+m+mi}{197}\PY{p}{,} \PY{l+m+mi}{477}\PY{p}{,} \PY{l+m+mi}{478}\PY{p}{,} \PY{l+m+mi}{479}\PY{p}{,} \PY{l+m+mi}{480}\PY{p}{,} \PY{l+m+mi}{481}\PY{p}{,} \PY{l+m+mi}{544}\PY{p}{,} \PY{l+m+mi}{545}\PY{p}{,} \PY{l+m+mi}{548}\PY{p}{,} \PY{l+m+mi}{549}
\PY{p}{)}

\PY{n}{POP\PYZus{}C\PYZus{}sIDs} \PY{o}{=} \PY{p}{(}
\PY{l+m+mi}{529}\PY{p}{,} \PY{l+m+mi}{530}\PY{p}{,} \PY{l+m+mi}{531}\PY{p}{,} \PY{l+m+mi}{532}\PY{p}{,} \PY{l+m+mi}{533}\PY{p}{,} \PY{l+m+mi}{537}\PY{p}{,} \PY{l+m+mi}{538}\PY{p}{,} \PY{l+m+mi}{539}\PY{p}{,} \PY{l+m+mi}{540}\PY{p}{,} \PY{l+m+mi}{541}\PY{p}{,} \PY{l+m+mi}{542}\PY{p}{,} \PY{l+m+mi}{543}
\PY{p}{)}

\PY{n}{pop\PYZus{}all} \PY{o}{=} \PY{n}{Population}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{pop\PYZus{}flow} \PY{o}{=} \PY{n}{Population}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{)}\PY{p}{,}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{pop\PYZus{}channel} \PY{o}{=} \PY{n}{Population}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{channel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{)}\PY{p}{,}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{channel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{pop\PYZus{}a} \PY{o}{=} \PY{n}{Population}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sIDs}\PY{o}{=}\PY{n}{POP\PYZus{}A\PYZus{}sIDs}\PY{p}{)}
\PY{n}{pop\PYZus{}b} \PY{o}{=} \PY{n}{Population}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sIDs}\PY{o}{=}\PY{n}{POP\PYZus{}B\PYZus{}sIDs}\PY{p}{)}
\PY{n}{pop\PYZus{}c} \PY{o}{=} \PY{n}{Population}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sIDs}\PY{o}{=}\PY{n}{POP\PYZus{}C\PYZus{}sIDs}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Define functions for center evaluation. These return dicts with score
names as keys. They need to return dicts of the same length with NaN
values if any error occurs, rather than skipping or any other behavior.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{summit\PYZus{}score}\PY{p}{(}\PY{n}{df}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{dict}\PY{p}{:}
\PY{k}{try}\PY{p}{:}
    \PY{n}{score} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{summit\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{mean}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{\PYZcb{}}
\PY{k}{except}\PY{p}{:}
    \PY{n}{score} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{summit\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{\PYZcb{}}
\PY{k}{return} \PY{n}{score}


\PY{k}{def} \PY{n+nf}{fit\PYZus{}mogi\PYZus{}function}\PY{p}{(}\PY{n}{df}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{)}\PY{p}{:}

\PY{c+c1}{\PYZsh{} initial guess lower than envelope}
\PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
    \PY{n}{p0} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{MAX\PYZus{}EPV} \PY{o}{/} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{TEST\PYZus{}D}
\PY{k}{else}\PY{p}{:}
    \PY{n}{p0} \PY{o}{=} \PY{n}{MAX\PYZus{}EPV} \PY{o}{/} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{TEST\PYZus{}D}

\PY{n}{params}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}
    \PY{n}{f}\PY{o}{=}\PY{n}{mogi\PYZus{}tilt}\PY{p}{,}
    \PY{n}{xdata}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
    \PY{n}{ydata}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
    \PY{n}{p0}\PY{o}{=}\PY{n}{p0}\PY{p}{,}
    \PY{n}{maxfev}\PY{o}{=}\PY{n}{MAX\PYZus{}ITERATIONS}\PY{p}{,}
    \PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lm}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{k}{return} \PY{n}{params}\PY{p}{,} \PY{n}{pcov}


\PY{k}{def} \PY{n+nf}{inflation\PYZus{}score}\PY{p}{(}\PY{n}{df}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{dict}\PY{p}{:}

\PY{c+c1}{\PYZsh{} get size of population before taking tiltable subset}
\PY{n}{pop\PYZus{}size} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}
\PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{notnull}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} initialize output}
\PY{n}{scores} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{frac\PYZus{}tiltable}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)} \PY{o}{/} \PY{n}{pop\PYZus{}size}\PY{p}{,}  \PY{c+c1}{\PYZsh{} doesn\PYZsq{}t depend on fit results}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log10\PYZus{}Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epv\PYZus{}is\PYZus{}positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epv\PYZus{}err}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}err}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}
\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} attempt regression}
\PY{k}{try}\PY{p}{:}
    \PY{n}{params}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{fit\PYZus{}mogi\PYZus{}function}\PY{p}{(}\PY{n}{df}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} unpack param estimate and variance}
    \PY{n}{epv}\PY{p}{,} \PY{n}{d} \PY{o}{=} \PY{n}{params}
    \PY{n}{epv\PYZus{}var}\PY{p}{,} \PY{n}{d\PYZus{}var} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{diag}\PY{p}{(}\PY{n}{pcov}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} calculate scores}
    \PY{n}{scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{epv}
    \PY{n}{scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log10\PYZus{}Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{epv}\PY{p}{)}\PY{p}{)}
    \PY{n}{scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epv\PYZus{}is\PYZus{}positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{epv} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}
    \PY{n}{scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epv\PYZus{}err}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{epv\PYZus{}var} \PY{o}{/} \PY{n}{epv}\PY{p}{)}
    \PY{n}{scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d}
    \PY{n}{scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}err}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{d\PYZus{}var} \PY{o}{/} \PY{n}{d}\PY{p}{)}

\PY{c+c1}{\PYZsh{} if regression fails, keep null values for scores}
\PY{k}{except}\PY{p}{:}
    \PY{k}{pass}

\PY{k}{return} \PY{n}{scores}
\end{Verbatim}
\end{tcolorbox}

A criterion is just a combination of an evaluation function and a
population on which to use it.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@dataclass}
\PY{k}{class} \PY{n+nc}{Criterion}\PY{p}{:}
\PY{n}{func}\PY{p}{:} \PY{n}{Callable}
\PY{n}{pop}\PY{p}{:} \PY{n}{Population}

\PY{n}{criteria} \PY{o}{=} \PY{p}{[}
\PY{n}{Criterion}\PY{p}{(}\PY{n}{summit\PYZus{}score}\PY{p}{,} \PY{n}{pop\PYZus{}all}\PY{p}{)}\PY{p}{,}
\PY{n}{Criterion}\PY{p}{(}\PY{n}{summit\PYZus{}score}\PY{p}{,} \PY{n}{pop\PYZus{}flow}\PY{p}{)}\PY{p}{,}
\PY{n}{Criterion}\PY{p}{(}\PY{n}{summit\PYZus{}score}\PY{p}{,} \PY{n}{pop\PYZus{}channel}\PY{p}{)}\PY{p}{,}
\PY{n}{Criterion}\PY{p}{(}\PY{n}{inflation\PYZus{}score}\PY{p}{,} \PY{n}{pop\PYZus{}a}\PY{p}{)}\PY{p}{,}
\PY{n}{Criterion}\PY{p}{(}\PY{n}{inflation\PYZus{}score}\PY{p}{,} \PY{n}{pop\PYZus{}b}\PY{p}{)}\PY{p}{,}
\PY{n}{Criterion}\PY{p}{(}\PY{n}{inflation\PYZus{}score}\PY{p}{,} \PY{n}{pop\PYZus{}c}\PY{p}{)}\PY{p}{,}
\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

Perform each evaluation for each center point. This takes less than two
minutes on my machine, the vast majority of which is from the curve\_fit
function calls.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{evaluate\PYZus{}center}\PY{p}{(}\PY{n}{center}\PY{p}{:} \PY{n}{Center}\PY{p}{,} \PY{n}{crit}\PY{p}{:} \PY{n}{Criterion}\PY{p}{)}\PY{p}{:}
\PY{n}{pop\PYZus{}subset} \PY{o}{=} \PY{n}{center}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{crit}\PY{o}{.}\PY{n}{pop}\PY{o}{.}\PY{n}{sIDs}\PY{p}{,} \PY{n}{crit}\PY{o}{.}\PY{n}{pop}\PY{o}{.}\PY{n}{feature}\PY{p}{)}\PY{p}{,} \PY{p}{:}\PY{p}{]}
\PY{k}{return} \PY{n}{crit}\PY{o}{.}\PY{n}{func}\PY{p}{(}\PY{n}{pop\PYZus{}subset}\PY{p}{)}


\PY{n}{scores} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{n}{score\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} note: will get score name out of order if any criteria throw errors, so those need to be handled in each evaluation function}
\PY{k}{for} \PY{n}{center} \PY{o+ow}{in} \PY{n}{centers\PYZus{}calc}\PY{p}{:}
\PY{n}{centers\PYZus{}eval} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{crit} \PY{o+ow}{in} \PY{n}{criteria}\PY{p}{:}
    \PY{n}{center\PYZus{}crit\PYZus{}scores} \PY{o}{=} \PY{n}{evaluate\PYZus{}center}\PY{p}{(}\PY{n}{center}\PY{p}{,} \PY{n}{crit}\PY{p}{)}
    \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n}{center\PYZus{}crit\PYZus{}scores}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{n}{centers\PYZus{}eval}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{val}\PY{p}{)}

        \PY{n}{full\PYZus{}score\PYZus{}name} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{crit}\PY{o}{.}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{key}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
        \PY{k}{if} \PY{n}{full\PYZus{}score\PYZus{}name} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{score\PYZus{}names}\PY{p}{:}
            \PY{n}{score\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{full\PYZus{}score\PYZus{}name}\PY{p}{)}
\PY{n}{scores}\PY{p}{[}\PY{n}{center}\PY{o}{.}\PY{n}{cID}\PY{p}{]} \PY{o}{=} \PY{n}{centers\PYZus{}eval}
\end{Verbatim}
\end{tcolorbox}

Write the evaluated scores to disk.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{centers\PYZus{}eval} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{scores}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}axis}\PY{p}{(}\PY{n}{score\PYZus{}names}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} replace inf with NaN to ensure export as numbers}
\PY{n}{centers\PYZus{}eval} \PY{o}{=} \PY{n}{centers\PYZus{}eval}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}

\PY{n}{centers\PYZus{}eval}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{map\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{centers\PYZus{}eval.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Are computed parameters simply ``hugging'' those used to define the mogi
tilt envelope? While they are centered around zero, they spread over
multiple orders of magnitude, particularly the energy term which is much
less constrained. Depth ranging over even a fraction of an oder of
magnitude is convincing here (considering that the true range of
realistic reservoir depths is a very narrow range).

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{envelope\PYZus{}hugging}\PY{p}{(}\PY{n}{pops}\PY{p}{:} \PY{n+nb}{list}\PY{p}{,} \PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} type: ignore}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}
\PY{n}{ax\PYZus{}epv} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{ax\PYZus{}d} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}

\PY{n}{ax\PYZus{}d}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}label\PYZus{}position}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{right}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}d}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{tick\PYZus{}right}\PY{p}{(}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}
    \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Parameter Estimates }\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{Hugging}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{ Envelope with }\PY{l+s+s1}{\PYZsq{}}
    \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}E\PYZus{}}\PY{l+s+si}{\PYZob{}PV\PYZcb{}}\PY{l+s+s2}{ = \PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{MAX\PYZus{}EPV}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ J, }\PY{l+s+s1}{\PYZsq{}}
    \PY{o}{+} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}d = \PYZdl{}}\PY{l+s+si}{\PYZob{}}\PY{n}{TEST\PYZus{}D}\PY{o}{/}\PY{l+m+mi}{1000}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ km}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}

\PY{k}{for} \PY{n}{pop} \PY{o+ow}{in} \PY{n}{pops}\PY{p}{:}

    \PY{n}{d\PYZus{}est} \PY{o}{=} \PY{n}{centers\PYZus{}eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}d\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}
        \PY{n}{centers\PYZus{}eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}d\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{notna}\PY{p}{(}\PY{p}{)}
    \PY{p}{]}
    \PY{n}{epv\PYZus{}est} \PY{o}{=} \PY{n}{centers\PYZus{}eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}
        \PY{n}{centers\PYZus{}eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{notna}\PY{p}{(}\PY{p}{)}
    \PY{p}{]}

    \PY{n}{n\PYZus{}d} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{d\PYZus{}est}\PY{p}{)}
    \PY{n}{n\PYZus{}epv} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{epv\PYZus{}est}\PY{p}{)}

    \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{epv\PYZus{}est} \PY{o}{/} \PY{n}{MAX\PYZus{}EPV}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                \PY{n}{ax}\PY{o}{=}\PY{n}{ax\PYZus{}epv}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ (n = }\PY{l+s+si}{\PYZob{}}\PY{n}{n\PYZus{}epv}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{d\PYZus{}est} \PY{o}{/} \PY{n}{TEST\PYZus{}D}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax\PYZus{}d}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ (n = }\PY{l+s+si}{\PYZob{}}\PY{n}{n\PYZus{}d}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{bw\PYZus{}adjust}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{sca}\PY{p}{(}\PY{n}{ax\PYZus{}d}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}\PY{p}{)}
\PY{n}{ax\PYZus{}d}\PY{o}{.}\PY{n}{vlines}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ymin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{ymax}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}d:\PYZdl{} fit / envelope}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{sca}\PY{p}{(}\PY{n}{ax\PYZus{}epv}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}\PY{p}{)}
\PY{n}{ax\PYZus{}epv}\PY{o}{.}\PY{n}{vlines}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{ymin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{ymax}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}E\PYZus{}}\PY{l+s+si}{\PYZob{}PV\PYZcb{}}\PY{l+s+s1}{:\PYZdl{} log |fit / envelope|}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{k}{if} \PY{n}{name} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
    \PY{n}{save\PYZus{}pdf}\PY{p}{(}\PY{n}{name}\PY{p}{)}

\PY{n}{envelope\PYZus{}hugging}\PY{p}{(}\PY{p}{[}\PY{n}{pop\PYZus{}a}\PY{p}{]}\PY{p}{,} \PY{p}{)} \PY{c+c1}{\PYZsh{} name=\PYZsq{}hugging\PYZhy{}a\PYZsq{}}
\PY{n}{envelope\PYZus{}hugging}\PY{p}{(}\PY{p}{[}\PY{n}{pop\PYZus{}c}\PY{p}{]}\PY{p}{,} \PY{p}{)} \PY{c+c1}{\PYZsh{} name=\PYZsq{}hugging\PYZhy{}c\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

Examine scatter plots and mogi fit functions for individual center
candidates relative to a population.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}scatter\PYZus{}fit}\PY{p}{(}\PY{n}{cIDs}\PY{p}{:} \PY{n+nb}{list}\PY{p}{,} \PY{n}{pop}\PY{p}{:} \PY{n}{Population}\PY{p}{,} \PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{show\PYZus{}max}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{show\PYZus{}min}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{height}\PY{p}{:} \PY{n+nb}{int} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} type: ignore}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{n}{height}\PY{p}{)}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}

\PY{k}{for} \PY{n}{cID} \PY{o+ow}{in} \PY{n}{cIDs}\PY{p}{:}
    \PY{n}{spot\PYZus{}check} \PY{o}{=} \PY{n}{centers\PYZus{}calc}\PY{p}{[}\PY{n}{cID} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{pop}\PY{o}{.}\PY{n}{sIDs}\PY{p}{,} \PY{n}{pop}\PY{o}{.}\PY{n}{feature}\PY{p}{)}\PY{p}{,} \PY{p}{:}\PY{p}{]}
    \PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{spot\PYZus{}check}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist\PYZus{}km}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n+nb}{eval} \PY{o}{=} \PY{n}{centers\PYZus{}eval}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{cID}\PY{p}{]}

    \PY{n}{pv} \PY{o}{=} \PY{n+nb}{eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}Epv\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{d} \PY{o}{=} \PY{n+nb}{eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}d\PYZus{}est}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{n}{frac} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n+nb}{eval}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}frac\PYZus{}tiltable}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}

    \PY{k}{if} \PY{o+ow}{not} \PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{pv}\PY{p}{)}\PY{p}{:}
        \PY{n}{mogi\PYZus{}dist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}
            \PY{l+m+mi}{0}\PY{p}{,}
            \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{spot\PYZus{}check}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{spot\PYZus{}check}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{notna}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+m+mi}{100}
        \PY{p}{)}
        \PY{n}{mogi\PYZus{}dist\PYZus{}km} \PY{o}{=} \PY{n}{mogi\PYZus{}dist} \PY{o}{/} \PY{l+m+mi}{1000}
        \PY{n}{label} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cID: }\PY{l+s+si}{\PYZob{}}\PY{n}{cID}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{. }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{log|E\PYZus{}}\PY{l+s+si}{\PYZob{}pv\PYZcb{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{ /}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{ J|\PYZdl{}: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PYZbs{}
            \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb}{round}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{pv}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, \PYZdl{}d\PYZdl{}: }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{round}\PY{p}{(}\PY{n}{d}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ (f = }\PY{l+s+si}{\PYZob{}}\PY{n}{frac}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{mogi\PYZus{}dist\PYZus{}km}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{mogi\PYZus{}tilt}\PY{p}{(}
            \PY{n}{mogi\PYZus{}dist}\PY{p}{,} \PY{n}{pv}\PY{p}{,} \PY{n}{d}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{label}\PY{p}{)}

\PY{c+c1}{\PYZsh{} set extent based on data first, then add envelope}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}
\PY{n}{add\PYZus{}envelope\PYZus{}to\PYZus{}plot}\PY{p}{(}\PY{n+nb}{max}\PY{o}{=}\PY{n}{show\PYZus{}max}\PY{p}{,} \PY{n+nb}{min}\PY{o}{=}\PY{n}{show\PYZus{}min}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tilt (deg)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Center Candidates for Pop. }\PY{l+s+si}{\PYZob{}}\PY{n}{pop}\PY{o}{.}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}}

\PY{c+c1}{\PYZsh{} save plot with name if passed as argument}
\PY{k}{if} \PY{n}{name} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
    \PY{n}{save\PYZus{}pdf}\PY{p}{(}\PY{n}{name}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}scatter\PYZus{}fit}\PY{p}{(}
\PY{p}{[}\PY{l+m+mi}{41}\PY{p}{,} \PY{l+m+mi}{81}\PY{p}{,} \PY{l+m+mi}{102}\PY{p}{,} \PY{l+m+mi}{103}\PY{p}{]}\PY{p}{,} \PY{n}{pop\PYZus{}a}\PY{p}{,} \PY{n}{show\PYZus{}min}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{show\PYZus{}max}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}
\PY{p}{)} \PY{c+c1}{\PYZsh{} name=\PYZsq{}scatter\PYZhy{}fit\PYZhy{}a\PYZsq{}}

\PY{n}{plot\PYZus{}scatter\PYZus{}fit}\PY{p}{(}
\PY{p}{[}\PY{l+m+mi}{197}\PY{p}{]}\PY{p}{,} \PY{n}{pop\PYZus{}a}\PY{p}{,} \PY{n}{show\PYZus{}min}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{show\PYZus{}max}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
\PY{p}{)} \PY{c+c1}{\PYZsh{} name=\PYZsq{}scatter\PYZhy{}fit\PYZhy{}a\PYZhy{}outlier\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

\hypertarget{numerical-model-data}{%
\section{Numerical Model Data}\label{numerical-model-data}}

Read initial positions and displacement vectors (radial and vertical
components) of mesh nodes.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../GEOL192\PYZhy{}Model/data/}\PY{l+s+s2}{\PYZdq{}}

\PY{c+c1}{\PYZsh{} paleo\PYZhy{}edifice spline data}
\PY{n}{topo} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{genfromtxt}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{z1.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{,}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{model\PYZus{}pos1\PYZus{}from\PYZus{}csv}\PY{p}{(}\PY{n}{name}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)}\PY{p}{:}
\PY{n}{r} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{genfromtxt}\PY{p}{(}\PY{n}{model\PYZus{}path} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rdisp\PYZus{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{name}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{,}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{z} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{interp}\PY{p}{(}\PY{n}{r}\PY{p}{,} \PY{o}{*}\PY{n}{topo}\PY{o}{.}\PY{n}{T}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{} interpolate z1 into topography}
\PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{z}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}


\PY{k}{def} \PY{n+nf}{model\PYZus{}disp\PYZus{}from\PYZus{}csv}\PY{p}{(}\PY{n}{name}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)}\PY{p}{:}
\PY{n}{r} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{genfromtxt}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{rdisp\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{,}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{z} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{genfromtxt}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{zdisp\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{,}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{z}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
\end{Verbatim}
\end{tcolorbox}

Define objects for displaced nodes and surface edges (the latter defined
by a consecutive pair of the former). Tilt calculation in the edge
class.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@dataclass}
\PY{k}{class} \PY{n+nc}{Node}\PY{p}{:}
\PY{n}{pos1}\PY{p}{:} \PY{n}{Tuple}\PY{p}{[}\PY{n+nb}{float}\PY{p}{,} \PY{n+nb}{float}\PY{p}{]}
\PY{n}{disp}\PY{p}{:} \PY{n}{Tuple}\PY{p}{[}\PY{n+nb}{float}\PY{p}{,} \PY{n+nb}{float}\PY{p}{]}

\PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}post\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos2} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{disp}


\PY{n+nd}{@dataclass}
\PY{k}{class} \PY{n+nc}{Edge}\PY{p}{:}
\PY{n}{proximal}\PY{p}{:} \PY{n}{Node}  \PY{c+c1}{\PYZsh{} (A in text)}
\PY{n}{distal}\PY{p}{:} \PY{n}{Node}  \PY{c+c1}{\PYZsh{} (B in text)}

\PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}post\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} relative dimensions [r, z] of initial and displaced segments}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{shape1} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{distal}\PY{o}{.}\PY{n}{pos1} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{proximal}\PY{o}{.}\PY{n}{pos1}  \PY{c+c1}{\PYZsh{} type: ignore}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{shape2} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{distal}\PY{o}{.}\PY{n}{pos2} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{proximal}\PY{o}{.}\PY{n}{pos2}  \PY{c+c1}{\PYZsh{} type: ignore}

    \PY{c+c1}{\PYZsh{} mean position of initial and displaced segments}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1} \PY{o}{=} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{distal}\PY{o}{.}\PY{n}{pos1} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{proximal}\PY{o}{.}\PY{n}{pos1}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}  \PY{c+c1}{\PYZsh{} type: ignore}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos2} \PY{o}{=} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{distal}\PY{o}{.}\PY{n}{pos2} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{proximal}\PY{o}{.}\PY{n}{pos2}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}  \PY{c+c1}{\PYZsh{} type: ignore}

    \PY{c+c1}{\PYZsh{} radial distances for plotting}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dist} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dist\PYZus{}km} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dist} \PY{o}{/} \PY{l+m+mi}{1000}

    \PY{c+c1}{\PYZsh{} initial and displaced slopes (positive downward from center)}
    \PY{c+c1}{\PYZsh{} index [1] is z component; [0] is r component}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{slope1} \PY{o}{=} \PY{n}{deg}\PY{p}{(}\PY{n}{arctan2}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{shape1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{shape1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{slope2} \PY{o}{=} \PY{n}{deg}\PY{p}{(}\PY{n}{arctan2}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{shape2}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{shape2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tilt} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{slope2} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{slope1}
\end{Verbatim}
\end{tcolorbox}

Define model class with parameter combination (geometry, overpressure).
It reads .csv files, builds nodes \& edges, etc.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@dataclass}
\PY{k}{class} \PY{n+nc}{Model}\PY{p}{:}
\PY{n}{params}\PY{p}{:} \PY{n+nb}{dict}

\PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}post\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{radius} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{radius}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{half\PYZus{}height} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{radius} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aspect}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dP} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pmult}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{*} \PYZbs{}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{*} \PY{n}{ROCK\PYZus{}DENSITY} \PY{o}{*} \PY{n}{MARS\PYZus{}GRAVITY}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{res\PYZus{}vol} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{4} \PY{o}{/} \PY{l+m+mi}{3}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{radius}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{half\PYZus{}height}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{epv} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dP} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{res\PYZus{}vol}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{half\PYZus{}height}

    \PY{n}{filename} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{depth\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}radius\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{radius}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}aspect\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aspect}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}pmult\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pmult}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}grav\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grav}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}topo\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{topo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{.csv}\PY{l+s+s2}{\PYZdq{}}

    \PY{c+c1}{\PYZsh{} read initial positions and displacements}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1} \PY{o}{=} \PY{n}{model\PYZus{}pos1\PYZus{}from\PYZus{}csv}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{disp} \PY{o}{=} \PY{n}{model\PYZus{}disp\PYZus{}from\PYZus{}csv}\PY{p}{(}\PY{n}{filename}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} subtract out gravitational component (with no overpressure)}
    \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grav}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
        \PY{n}{filename\PYZus{}p0} \PY{o}{=} \PY{n}{filename}\PY{o}{.}\PY{n}{replace}\PY{p}{(}
            \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pmult\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pmult}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pmult\PYZus{}0}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{disp} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{n}{model\PYZus{}disp\PYZus{}from\PYZus{}csv}\PY{p}{(}\PY{n}{filename\PYZus{}p0}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} make z1 flat for flat model}
    \PY{k}{if} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{topo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} build nodes from pos1 and disp if pos1 within defined length}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}nodes} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1}\PY{p}{)}
                          \PY{k}{if} \PY{n}{val}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{PLOT\PYZus{}WIDTH}\PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{nodes} \PY{o}{=} \PY{p}{[}\PY{n}{Node}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{pos1}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{disp}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                  \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}nodes}\PY{p}{)}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} build edges from consecutive node pairs}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{node\PYZus{}pairs} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{nodes}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{nodes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{edges} \PY{o}{=} \PY{p}{[}\PY{n}{Edge}\PY{p}{(}\PY{o}{*}\PY{n}{pair}\PY{p}{)} \PY{k}{for} \PY{n}{pair} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{node\PYZus{}pairs}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} put edge attributes into dict of lists}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
        \PY{p}{[}\PY{n+nb}{vars}\PY{p}{(}\PY{n}{edge}\PY{p}{)} \PY{k}{for} \PY{n}{edge} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{edges}\PY{p}{]}\PY{p}{)}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{attributes} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}dict}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{list}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Define parametric sweep class to mirror COMSOL iterative modelling. It
includes a flexible plot function which distinguishes between constant
and variable parameters within the sweep and can handle comparisons with
the analytical Mogi solution.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} parameter sweep in SI units (to match csv output from COMSOL)}
\PY{k}{class} \PY{n+nc}{ParamSweep}\PY{p}{:}
\PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{params}\PY{p}{:} \PY{n+nb}{dict}\PY{p}{)}\PY{p}{:}

    \PY{c+c1}{\PYZsh{} define constant parameters for labelling once in title}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{constants} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{key}\PY{p}{:} \PY{n}{val}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                      \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n}{params}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{val}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{\PYZcb{}}

    \PY{c+c1}{\PYZsh{} define variable parameters for labelling individually}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{variables} \PY{o}{=} \PY{p}{[}\PY{n}{key} \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n}{params}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{val}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{]}

    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{models} \PY{o}{=} \PY{p}{[}\PY{n}{Model}\PY{p}{(}\PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{params}\PY{p}{,} \PY{n}{item}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                   \PY{k}{for} \PY{n}{item} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{product}\PY{p}{(}\PY{o}{*}\PY{n}{params}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{]}

\PY{k}{def} \PY{n+nf}{plot}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{calc\PYZus{}mogi}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{fit\PYZus{}mogi}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} type: ignore}

    \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}

    \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{constants}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{replace}\PY{p}{(}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    
    \PY{k}{for} \PY{n}{model} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{models}\PY{p}{:}

        \PY{n}{model\PYZus{}epv} \PY{o}{=} \PY{n}{calculate\PYZus{}epv}\PY{p}{(}
            \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{radius}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aspect}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pmult}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{p}{)}

        \PY{c+c1}{\PYZsh{} define variables specific to each config}
        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{variables}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                \PY{p}{\PYZob{}}\PY{n}{param}\PY{p}{:} \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{n}{param}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{variables}\PY{p}{\PYZcb{}}\PY{p}{)}
            \PY{n}{label} \PY{o}{=} \PY{n}{label}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n}{label} \PY{o}{=} \PY{n}{label}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n}{label} \PY{o}{=} \PY{n}{label}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{k}{else}\PY{p}{:}
            \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}

        \PY{c+c1}{\PYZsh{} plot numerical output}
        \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{attributes}\PY{p}{,}
                         \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tilt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dist\PYZus{}km}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Numerical}\PY{l+s+si}{\PYZob{}}\PY{n}{label}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{k}{if} \PY{n}{calc\PYZus{}mogi}\PY{p}{:}
            \PY{n}{dist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
            \PY{n}{dist\PYZus{}km} \PY{o}{=} \PY{n}{dist} \PY{o}{/} \PY{l+m+mi}{1000}
            \PY{n}{tilt} \PY{o}{=} \PY{n}{mogi\PYZus{}tilt}\PY{p}{(}
                \PY{n}{dist}\PY{o}{=}\PY{n}{dist}\PY{p}{,}
                \PY{n}{epv}\PY{o}{=}\PY{n}{model\PYZus{}epv}\PY{p}{,}
                \PY{n}{d}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{p}{)}
            \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{dist\PYZus{}km}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{tilt}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mogi (calc)}\PY{l+s+si}{\PYZob{}}\PY{n}{label}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{k}{if} \PY{n}{fit\PYZus{}mogi}\PY{p}{:}
            \PY{n}{params}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n}{fit\PYZus{}mogi\PYZus{}function}\PY{p}{(}\PY{n}{df}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{data}\PY{p}{)}
            \PY{n}{epv}\PY{p}{,} \PY{n}{d} \PY{o}{=} \PY{n}{params}

            \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist\PYZus{}km}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{mogi\PYZus{}tilt}\PY{p}{(}
                \PY{n}{model}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{epv}\PY{p}{,} \PY{n}{d}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mogi (fit)}\PY{l+s+si}{\PYZob{}}\PY{n}{label}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
            \PY{n}{epv\PYZus{}overestimate} \PY{o}{=} \PY{n}{epv} \PY{o}{/} \PY{n}{model\PYZus{}epv}
            \PY{n}{d\PYZus{}overestimate} \PY{o}{=} \PY{n}{d} \PY{o}{/} \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

            \PY{n}{title} \PY{o}{+}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ Fitted parameter overestimation Factors: }\PY{l+s+s1}{\PYZsq{}}
            \PY{n}{title} \PY{o}{+}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}E\PYZus{}}\PY{l+s+si}{\PYZob{}PV\PYZcb{}}\PY{l+s+s1}{:\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb}{round}\PY{p}{(}\PY{n}{epv\PYZus{}overestimate}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}
            \PY{n}{title} \PY{o}{+}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}d:\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n+nb}{round}\PY{p}{(}\PY{n}{d\PYZus{}overestimate}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}


    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{title}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Distance (km)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} plt.xlim(8, 16) }
    \PY{c+c1}{\PYZsh{} plt.ylim(.34, .37)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Tilt (deg)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{upper right}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} save plot with name if passed as argument}
    \PY{k}{if} \PY{n}{name} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{save\PYZus{}pdf}\PY{p}{(}\PY{n}{name}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Define specific parametric sweeps.

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{grav\PYZus{}topo\PYZus{}test\PYZus{}sweep} \PY{o}{=} \PY{n}{ParamSweep}\PY{p}{(}\PY{p}{\PYZob{}}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{15\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{radius}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{20\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aspect}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{.4}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pmult}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{.6}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grav}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{True}\PY{p}{,} \PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{topo}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{True}\PY{p}{,} \PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{n}{mogi\PYZus{}shallow\PYZus{}oblate\PYZus{}test\PYZus{}sweep} \PY{o}{=} \PY{n}{ParamSweep}\PY{p}{(}\PY{p}{\PYZob{}}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{15\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{radius}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{20\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aspect}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{.4}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pmult}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{.6}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grav}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{topo}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{True}\PY{p}{]}\PY{p}{,}
\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{n}{mogi\PYZus{}test\PYZus{}sweep} \PY{o}{=} \PY{n}{ParamSweep}\PY{p}{(}\PY{p}{\PYZob{}}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{25\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{radius}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{5\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aspect}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pmult}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grav}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{topo}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{n}{full\PYZus{}sweep} \PY{o}{=} \PY{n}{ParamSweep}\PY{p}{(}\PY{p}{\PYZob{}}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{25\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{radius}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{5\PYZus{}000}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aspect}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pmult}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grav}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{topo}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{k+kc}{False}\PY{p}{]}\PY{p}{,}
\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{grav\PYZus{}topo\PYZus{}test\PYZus{}sweep}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}  \PY{c+c1}{\PYZsh{} name=\PYZsq{}grav\PYZhy{}topo\PYZhy{}test\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{mogi\PYZus{}test\PYZus{}sweep}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{calc\PYZus{}mogi}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{fit\PYZus{}mogi}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}  \PY{c+c1}{\PYZsh{} name=\PYZsq{}mogi\PYZhy{}test\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} name=\PYZsq{}mogi\PYZhy{}test\PYZhy{}shallow\PYZhy{}oblate\PYZsq{}}
\PY{n}{mogi\PYZus{}shallow\PYZus{}oblate\PYZus{}test\PYZus{}sweep}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{calc\PYZus{}mogi}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{fit\PYZus{}mogi}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

Define a function for plotting a full center scatter plot against a
numerical sweep. (Not used in manuscript).

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{combined\PYZus{}plot}\PY{p}{(}\PY{n}{sweep}\PY{p}{:} \PY{n}{ParamSweep}\PY{p}{,} \PY{n}{centers}\PY{p}{:} \PY{n+nb}{list}\PY{p}{[}\PY{n}{Center}\PY{p}{]}\PY{p}{,} \PY{n}{name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{} type: ignore}
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}

\PY{k}{for} \PY{n}{model} \PY{o+ow}{in} \PY{n}{sweep}\PY{o}{.}\PY{n}{models}\PY{p}{:}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{p}{\PYZob{}}\PY{n}{param}\PY{p}{:} \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{n}{param}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{sweep}\PY{o}{.}\PY{n}{variables}\PY{p}{\PYZcb{}}\PY{p}{)}
    \PY{n}{label} \PY{o}{=} \PY{n}{label}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{label} \PY{o}{=} \PY{n}{label}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{label} \PY{o}{=} \PY{n}{label}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{attributes}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tilt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dist\PYZus{}km}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{label}\PY{p}{)}

\PY{k}{for} \PY{n}{center} \PY{o+ow}{in} \PY{n}{centers}\PY{p}{:}
    \PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{center}\PY{o}{.}\PY{n}{data}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist\PYZus{}km}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{center}\PY{o}{.}\PY{n}{cID}\PY{p}{)}

\PY{n}{model\PYZus{}title} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sweep}\PY{o}{.}\PY{n}{constants}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model\PYZus{}title} \PY{o}{=} \PY{n}{model\PYZus{}title}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{model\PYZus{}title} \PY{o}{=} \PY{n}{model\PYZus{}title}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{model\PYZus{}title} \PY{o}{=} \PY{n}{model\PYZus{}title}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Radial Tilt: }\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}title}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Model Parameters: }\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}title}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Distance (km)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Tilt (deg)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} save plot with name if passed as argument}
\PY{k}{if} \PY{n}{name} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
    \PY{n}{save\PYZus{}pdf}\PY{p}{(}\PY{n}{name}\PY{p}{)}

\PY{n}{combined\PYZus{}plot}\PY{p}{(}\PY{n}{mogi\PYZus{}shallow\PYZus{}oblate\PYZus{}test\PYZus{}sweep}\PY{p}{,} \PY{p}{[}\PY{n}{centers\PYZus{}calc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}