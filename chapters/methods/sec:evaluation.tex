\section{Evaluating Center Candidates}\label{sec:evaluation}

% Inflation Center Evaluation
    % handling mathematical and physical errors from map-tilt equation
    % fraction ``tiltable'' (math and phys)
    % non-linear least squares regression using the analytical tilt function. Instead of estimating slope and intercept (two parameters in a linear equation) I estimate depth and inflation energy, the two parameters in Mogi tilt equation.
        % goodness of fit
        % depth and energy estimates
    % assessing the spatial distribution of inflation center evaluations for each sample population

In this section, I define two broad criteria by which to evaluate the axisymmetric center candidates shown in Figure~\ref{fig:candidates} based on their spatial relationship with mapped sample data. Broadly speaking, these criteria are designed to answer the question ``is this candidate location reasonable as an axisymmetric center point?'' Importantly, two different locations may each individually explain different aspects of the study area. Additionally, the answer to ``where is the most likely center location'' may have a different answer even based on the same criterion if different sample populations are considered. After all, my goal is not to construct a single axisymmetric model but to determine the best explanations for all observed data by more flexibly applying the axisymmetric framework.

I illustrate the flow of this iterative approach abstractly in Figure~\ref{fig:eval-model} and present the Python implementation in Appendix~\ref{app:code}. In the following sections, I describe the specific criteria used to evaluate different aspects of the summit's geometry and history.

\begin{figure}
    \input{figures/methods/eval-model.tex}%
    \caption[Center evaluation workflow]{Schematic illustration of candidate center evaluation process. For each center (unique cID) in \hltt{centers.csv}, I make a copy of \hltt{samples.csv} and calculate variables for each sample (unique sID). This results in the ``intermediate list'' where each element corresponds to one cID. Then I evaluate each item in this list and write the resulting scores to one row of \hltt{centers\_eval.csv}.}%
    \label{fig:eval-model}
\end{figure}

\subsection{Paleo-Summit}\label{sec:paleo-summit}

The center location which best explains an axisymmetric paleo-edifice summit is the one for which flow features are pointing downhill away from the center as directly possible. In other words, this point is the one which minimizes the average value of $\beta_1$ for all the sampled points. For this criterion, I use both the full sample dataset and populations broken down by feature type (polygon flow and linear channel). Estimated paleo-summits differing by feature type could suggest that the features erupted under different topographic conditions and thus at different times, with regional deformation occurring between eruptive periods.

\subsection{Inflation Center}\label{sec:inflation-center}

Identifying and evaluating axisymmetric inflation (or deflation) centers is considerably more difficult for several reasons.

First, very little information can be derived from a single center-sample pair of points. That is because the single resulting tilt-distance data point could be consistent with any number of reservoir pressure conditions---or more likely, simply a mathematical calculation with no physical basis since the actual tilt at that point occurred about a different axis of rotation. Therefore, simply calculating an average value for some variable over all sample points (as in the previous case) will not be sufficient.

Instead, I need to consider a larger population of tilt-distance data points together. This increases the likelihood of recognizing a tilt pattern consistent with reservoir pressure change, i.e., a shape similar to those shown in Figures~\ref{fig:grav-topo-test},~\ref{fig:mogi-test}, and~\ref{fig:mogi-test-shallow-oblate}. However, this alone does not address the second issue, that erroneously calculated tilt values will often be present alongside any true tilt patterns consistent with axisymmetric tilt from the inflation center in question. Of course, identifying these erroneous calculations as such would require independent knowledge of the axis and degree of tilt responsible, which is exactly what I am trying to determine.

The next best option is to discard any calculations which \emph{must} be erroneous, recognizing that some will have to remain to have any chance of identifying real tilt signatures. To do this, I first calculate each tilt value using Equation~\eqref{eq:tilt-from-map} and the \acs{az1}-uncertainty correction illustrated in Figure~\ref{fig:az1-uncertainty}. Specifically, this correction involves setting the tilt for any points where $\acs{disc}<\ang{7}$ to $\acs{tilt}=\ang{0}$, and for the remaining points calculating \acs{tilt} for the two boundaries of the uncertainty region, then taking the lower of the two (if one exists at all).

Then, I compute an analytical tilt solution to a deep, high-\acs{epv} inflation (or deflation), as shown Figure~\ref{fig:envelope}. This is designed to place an upper bound on realistic tilt at each distance from the center, so any computed tilt values which exceed this envelope are discarded due to physical implausibility. This function needs an especially high \acs{epv} in light of Figure~\ref{fig:mogi-test-shallow-oblate}; shallow oblate reservoirs are best approximated by slightly deeper and \emph{much} more energetic inflations, and I want to be confident that the cutoff envelope exceeds any realistic conditions.

\begin{figure}
    \includegraphics[width=\textwidth]{methods/envelope.pdf}%
    \caption[Physically plausible tilt envelope]{Upper and lower plausibility bounds on tilt as a function of distance. This function is computer using a relatively deep and extremely high-\acs{epv} Mogi function to ensure appropriate breadth and width is included, keeping in mind that the true reservoir is likely to be oblate. Any computed tilt values outside this envelope are discarded on physical grounds.}%
    \label{fig:envelope}
\end{figure}

During this process, I count the number of points discarded due either to mathematical or physical implausibility---this number itself is an important criterion for evaluating the inflation center candidate.

Finally, I perform a non-linear least-squares regression using the \hltt{curve\_fit} function from the \hltt{scipy.optimize} Python module \parencite{2020SciPy-NMeth} to fit Equation~\eqref{eq:mogi-tilt} (the analytical tilt solution) to the tilt-distance dataset. Just as a linear regression computes the best-fitting slope and intercept, this process computes the best-fitting depth and energy parameters. In both cases, the best fit minimizes the mean square error:
\begin{equation}
    \frac{1}{n}\sum_{i}^{n}{\left[\acs{tilt}_i-\hat{\acs{tilt}}_i\right]}^2\label{eq:mse}
\end{equation}
for $n$ observations of the form $(\acs{dist}, \acs{tilt})$ where $\hat{\acs{tilt}}$ is evaluated at $\acs{dist}$ using the best-fit parameters. The details of the curve-fitting algorithm (Levenberg-Marquardt) are beyond the scope of this thesis, but one important difference from a simpler linear regression model is that the curve does not necessarily converge (successfully estimate a set of best-fitting parameters) for particularly messy datasets. Whether convergence occurs (and even the final parameter estimates) depends on initial parameter estimates and maximum number of iterations allowed before ``giving up'' on convergence.

I use initial parameter estimates for inflation energy $\acs{epv} = \qty{7e19}{\J}$ (three orders of magnitude lower than that used to define the maximum tilt envelope in Figure~\ref{fig:envelope}) and depth $d = \qty{20}{\km}$ (the same depth in the envelope). If the mean tilt of the dataset is negative, I use a negative \acs{epv} initial estimate of the same magnitude. I allow 80 iterations before a dataset is deemed non-convergent, i.e., not explainable by an analytical tilt model of the form presented in Equation~\eqref{eq:mogi-tilt}.

After performing each regression, I first assess the mathematical goodness of fit for each center's fitted tilt solution. First, what fraction of the samples are plausibly ``tiltable,'' i.e., their calculated tilt values are within the tilt envelope? Recall that the regression only proceeds using this subset, so the fraction of the dataset involved provides important context for the second criterion: what is the \ac{RMSE} of the regression, if one converges at all? This statistic is simply the square root of Equation~\eqref{eq:mse}:
\begin{equation}
    \sqrt{\frac{1}{n}\sum_{i}^{n}{\left[\acs{tilt}_i-\hat{\acs{tilt}}_i\right]}^2}.\label{eq:rmse}
\end{equation}
It has the same units as \acs{tilt} (degrees) and provides a relative comparison of goodness-of-fit for regression results; smaller values indicate better fit. Taken together, the ``tiltable'' fraction and \ac{RMSE} associated with each center reflect the mathematical goodness-of-fit for each center candidate.

I use these fitted values and crucially, their associated error terms, to determine the likelihood that surface tilt actually occurred in the direction radial to the given center candidate. This approach is supported by Figure~\ref{fig:mogi-test-shallow-oblate}, which illustrates that even tilt resulting from shallow, oblate reservoirs within a topographic edifice can be fit well to the analytical Mogi tilt function. At this stage, I pay closer attention to the parameter error estimates (similar to an $R^2$ value for a linear regression) to determine whether \emph{any} axisymmetric tilt is likely to have occurred from this center, rather than the estimates themselves---although I treat any unrealistic parameter estimates with caution regardless of their goodness of fit.

This sequence of calculations is much more computationally expensive than the previous one, and a single realistic reservoir pressure change is unlikely to explain the entire dataset anyway. Therefore, I select smaller sample populations for this criterion, paying particular attention to the highly discordant flows near the southern summit region shown in Figure~\ref{fig:uphill-flows}.

%\subsection{Evaluating Reservoir Pressure Change Parameters}

%Note: for reasons presented in Chapter~\ref{cha:discussion}, this is a time-permitting element for the final submission of this thesis.

%Finally, I draw on the preliminary result shown in Figure~\ref{fig:mogi-test-shallow-oblate}: map data which are well fit by the analytical Mogi tilt solution are also likely to fit one or more numerical results. For the most promising center candidates, I examine these numerical results to identify which set of reservoir conditions most closely match the fitted analytical function, and more importantly the map-derived tilt dataset itself.