\section{Assessing Reservoir Conditions}\label{sec:evaluation}

In this section I evaluate map-derived tilt-distance datasets generated in Section~\ref{sec:mapping} by comparison with model tilt-distance solutions from Section~\ref{sec:modeling}. The primary goal is to estimate an array of magma reservoir parameters---center position (map view), depth, radius (map view), aspect ratio, and pressure change---most consistent with the discordant flows at the surface. 

Among these five parameters of interest, reservoir center position must be assessed first because it alone dictates the tilt-distance dataset implied by a discordant set of features. This derived tilt-distance dataset can then be compared with an array of tilt-distance solutions derived from numerical models incorporating the other four parameters.

\subsection{Center Position}\label{sec:center-location}

Figure~\ref{fig:candidates} illustrates the array of candidates to be assessed as possible reservoir center locations. Section~\ref{sec:mapping} introduces the construction of a single tilt-distance data point from one discordant sample point relative to one center location. Repeating this calculation for all sample points relative to one center yields a full tilt-distance dataset corresponding to that center.\footnote{Figure~\ref{fig:tilt-example} illustrates instead repeating this calculation for a single sample point relative to all possible centers.} By repeating this construction, each center candidate can be evaluated on the basis of its associated tilt-distance dataset. In general, this means each dataset is reduced to a small set of numerical scores. This approach is outlined in Figure~\ref{fig:eval-model}. Two broad questions inform the numerical scores assigned to each center based on its associated tilt-distance dataset:
\begin{enumerate}
    \item How well does the dataset capture the mapped discordant features?
    \item How well does the dataset capture a plausible modeled reservoir change event?
\end{enumerate}
Naturally, the best centers are the ones whose datasets can explain both the discordant features and a plausible reservoir change event.

\begin{figure}
    \input{figures/methods/eval-model.tex}%
    \caption[Center evaluation process]{Schematic illustration of candidate center evaluation process. For each center (unique cID) in \hltt{centers.csv}, I make a copy of \hltt{samples.csv} and calculate variables for each sample (unique sID). This results in the ``intermediate list'' where each element corresponds to one cID. Then I evaluate each item in this list and write the resulting scores to one row of \hltt{centers\_eval.csv}.}%
    \label{fig:eval-model}
\end{figure}

A sample is well explained by a center if it is both tiltable (Section~\ref{sec:tiltable}) and offset (Section~\ref{sec:offset}). Likewise, the full array of discordant features is well explained by a center if a large fraction of the samples in the associated tilt-distance dataset are both tiltable and offset. Thus the score which captures how well each center explains a particular set of discordant samples is the fraction of those samples which are both tiltable and offset, ranging from 0 (worst) to 1 (best).

Meanwhile, a tilt-distance dataset captures a plausible reservoir pressure change if it is well fit by a model tilt solution such as those shown in Figures~\ref{fig:grav-topo-test},~\ref{fig:mogi-test}, and~\ref{fig:mogi-test-shallow-oblate}. Crucially, Figure~\ref{fig:mogi-test-shallow-oblate} shows that even reservoirs that violate the analytical assumption of a deep point-like reservoir are qualitatively similar to some analytical solution---an equation of the form given in Equation~\eqref{eq:mogi-tilt}.

To quantify this goodness of fit, I perform a least-squares regression\footnote{Implemented using the \hltt{curve\_fit} function from the \hltt{scipy.optimize} Python module \parencite{2020SciPy-NMeth}} to fit an analytical tilt solution to the tiltable/offset samples in each dataset. Just as a linear regression computes the best-fitting slope and intercept, this process computes the best-fitting depth and energy parameters. In both cases, the best fit minimizes the mean square error:
\begin{equation}
    \frac{1}{n}\sum_{i}^{n}{\left[\acs{tilt}_i-\hat{\acs{tilt}}_i\right]}^2\label{eq:mse}
\end{equation}
for $n$ observations of the form $(\acs{dist}, \acs{tilt})$ where expected tilt $\hat{\acs{tilt}}$ is evaluated at distance $\acs{dist}$ using the best-fit parameterization of Equation~\eqref{eq:mogi-tilt}. The details of the curve-fitting algorithm (Levenberg-Marquardt) are beyond the scope of this thesis, but one important difference from a simpler linear model is that the curve does not necessarily converge, i.e., successfully estimate a set of best-fitting parameters, for especially messy datasets. Whether convergence occurs (and even the final parameter estimates) depends on initial parameter estimates and maximum number of iterations allowed before ``giving up'' on convergence.

Initial parameter estimates for inflation energy are $\acs{epv} = \qty{7e19}{\J}$ if the mean tilt in the dataset is positive and \qty{-7e19}{\J} if the mean tilt is negative. The initial depth estimate is $d = \qty{20}{\km}$ in either case. 500 iterations are allowed before a dataset is deemed non-convergent, i.e., not explainable by an analytical tilt model in the form of Equation~\eqref{eq:mogi-tilt}. For centers where the regression converges, I report the \ac{RMSE}---the square root of Equation~\eqref{eq:mse}:
\begin{equation}
    \sqrt{\frac{1}{n}\sum_{i}^{n}{\left[\acs{tilt}_i-\hat{\acs{tilt}}_i\right]}^2}.\label{eq:rmse}
\end{equation}
This statistic has the same units as \acs{tilt} (degrees) and provides a relative comparison of goodness-of-fit for regression results; smaller values indicate better fit. Note that \acs{RMSE} values cannot be directly compared between regressions with different samples sizes. Thus the \acs{RMSE} must be interpreted together with the tiltable/offset fraction. These two scores reflect the degree to which a center location can link mapped discordant features to a plausible model tilt solution.

\subsection{Depth, Radius, Aspect Ratio, \& Pressure Change}

Recall from Figure~\ref{fig:mogi-test-shallow-oblate}. First, even model tilt solutions which violate \textcite{mogi_relations_1958} reservoir assumptions (e.g., shallow and oblate rather than deep and point-like) retain the qualitative features of this analytical solution. This is the justification for the analytical approach of the previous section. However, the numerical parameter estimates associated with these solutions diverge rapidly. Therefore, the best-fit parameter estimates emerging from the least-squares regression (Section~\ref{sec:center-location}) are of little value. After identifying a range of plausible inflation center locations, numerical models are thus necessary to estimate reservoir radius, depth, aspect ratio, and pressure change.

I use the same iterative optimization method (minimizing \acs{RMSE}) described in Section~\ref{sec:center-location} to find the best numerical fit. In the absence of an explicit tilt equation parameterized by reservoir size, depth, shape, and pressure change, I perform a brute-force search through an array of numerical solutions at each iteration. As in the analytical regression, this process requires an initial set of parameter estimates. Instead of evaluating the \acs{RMSE} of each tilt solution individually to inform the subsequent estimate, I calculate an array of tilt solutions all at once using the \hlss{Parametric Sweep} tool in COMSOL. After sorting this array of solutions by their \acs{RMSE}, I examine a few of the best-fitting results. These results then inform the next iteration, i.e., a new array of parameters clustered around the previous best fit. Just as in the analytical regression, this process is complete when the \acs{RMSE} no longer changes (within a small tolerance) with additional iterations of parameter estimates.

It is worth pointing out a few important limitations of this \acs{RMSE}-minimizing procedure, both for the analytical curve-fitting implementation and the brute force search through numerical results. The similarity in tilt solutions between oblate and point-like reservoirs illustrated in Figure~\ref{fig:mogi-test-shallow-oblate} is crucial for the validity of the analytical regression; it also implies that an observed tilt-distance dataset is well-described by multiple reservoir configurations. It is important to keep in mind the non-uniqueness of solutions when interpreting numerical results under this method. Therefore, after identifying a minimum-\acs{RMSE} numerical solution to explain a tilt-distance dataset, I repeat the process using an entirely different starting set of parameter guesses. In the extreme example already introduced, if I identify a deep point-like reservoir to fit a particular dataset, I then attempt to match or exceed this fit using a shallow oblate reservoir.